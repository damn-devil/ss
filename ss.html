<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üåÄ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-user-select: none;
            user-select: none;
        }

        body {
            background: #000;
            overflow: hidden;
            height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        .plasma-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            overflow: hidden;
        }

        .plasma-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            filter: brightness(1.2) contrast(1.3) saturate(1.4);
        }

        .audio-bars {
            position: absolute;
            bottom: 10%;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: end;
            gap: 3px;
            height: 60px;
        }

        .bar {
            width: 4px;
            background: linear-gradient(to top, #00ffff, #ff00ff);
            border-radius: 2px;
            transition: height 0.1s ease;
        }

        .touch-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10000;
            cursor: pointer;
        }

        .pulse-effect {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255, 0, 255, 0.8) 0%, transparent 70%);
            transform: translate(-50%, -50%);
            opacity: 0;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div class="plasma-container">
        <canvas class="plasma-canvas" id="plasmaCanvas"></canvas>
        <div class="audio-bars" id="audioBars"></div>
        <div class="touch-layer" id="touchLayer"></div>
    </div>

    <audio id="audioElement" loop>
        <source src="sound.mp3" type="audio/mpeg">
    </audio>

    <script>
        class PlasmaVisualizer {
            constructor() {
                this.canvas = document.getElementById('plasmaCanvas');
                this.ctx = this.canvas.getContext('2d');
                this.audioBars = document.getElementById('audioBars');
                this.audioContext = null;
                this.analyser = null;
                this.dataArray = null;
                this.source = null;
                this.animationId = null;
                this.time = 0;
                
                this.resize();
                this.createAudioBars();
                this.setupEventListeners();
            }

            resize() {
                this.canvas.width = window.innerWidth * window.devicePixelRatio;
                this.canvas.height = window.innerHeight * window.devicePixelRatio;
                this.ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
            }

            createAudioBars() {
                for (let i = 0; i < 64; i++) {
                    const bar = document.createElement('div');
                    bar.className = 'bar';
                    bar.style.height = '2px';
                    this.audioBars.appendChild(bar);
                }
            }

            setupEventListeners() {
                window.addEventListener('resize', () => this.resize());
            }

            initAudioAnalyser(audioElement) {
                this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                this.analyser = this.audioContext.createAnalyser();
                this.source = this.audioContext.createMediaElementSource(audioElement);
                
                this.source.connect(this.analyser);
                this.analyser.connect(this.audioContext.destination);
                
                this.analyser.fftSize = 256;
                const bufferLength = this.analyser.frequencyBinCount;
                this.dataArray = new Uint8Array(bufferLength);
            }

            renderPlasma() {
                const width = this.canvas.width / window.devicePixelRatio;
                const height = this.canvas.height / window.devicePixelRatio;
                
                this.ctx.clearRect(0, 0, width, height);
                
                let bass = 0;
                let mid = 0;
                let high = 0;
                
                if (this.analyser && this.dataArray) {
                    this.analyser.getByteFrequencyData(this.dataArray);
                    
                    // –ù–∏–∑–∫–∏–µ —á–∞—Å—Ç–æ—Ç—ã (–±–∞—Å)
                    for (let i = 0; i < 8; i++) {
                        bass += this.dataArray[i];
                    }
                    bass /= 8;
                    
                    // –°—Ä–µ–¥–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã
                    for (let i = 8; i < 32; i++) {
                        mid += this.dataArray[i];
                    }
                    mid /= 24;
                    
                    // –í—ã—Å–æ–∫–∏–µ —á–∞—Å—Ç–æ—Ç—ã
                    for (let i = 32; i < 64; i++) {
                        high += this.dataArray[i];
                    }
                    high /= 32;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∞—É–¥–∏–æ –±–∞—Ä—ã
                    this.updateAudioBars();
                }
                
                const bassIntensity = (bass || 50) / 255;
                const midIntensity = (mid || 50) / 255;
                const highIntensity = (high || 50) / 255;
                
                const imageData = this.ctx.createImageData(width, height);
                const data = imageData.data;
                
                for (let y = 0; y < height; y++) {
                    for (let x = 0; x < width; x++) {
                        const i = (y * width + x) * 4;
                        
                        // –ü–ª–∞–∑–º–µ–Ω–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è —Å —Ä–µ–∞–∫—Ü–∏–µ–π –Ω–∞ –∑–≤—É–∫
                        const nx = x / width - 0.5;
                        const ny = y / height - 0.5;
                        
                        const distance = Math.sqrt(nx * nx + ny * ny);
                        const angle = Math.atan2(ny, nx);
                        
                        // –û—Å–Ω–æ–≤–Ω–∞—è –ø–ª–∞–∑–º–∞ —Å –ø—É–ª—å—Å–∞—Ü–∏–µ–π –æ—Ç –±–∞—Å–∞
                        const plasma1 = Math.sin(distance * 20 - this.time * 2 + bassIntensity * 10) * 0.5 + 0.5;
                        const plasma2 = Math.sin(angle * 8 + this.time * 3 + midIntensity * 8) * 0.5 + 0.5;
                        const plasma3 = Math.sin((nx * Math.sin(this.time * 0.5) + ny * Math.cos(this.time * 0.3)) * 15 + highIntensity * 12) * 0.5 + 0.5;
                        
                        // –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–ª–∞–∑–º–∞
                        const plasma = (plasma1 + plasma2 + plasma3) / 3;
                        
                        // –¶–≤–µ—Ç–æ–≤–∞—è –ø–∞–ª–∏—Ç—Ä–∞ —Å —Ä–µ–∞–∫—Ü–∏–µ–π –Ω–∞ —á–∞—Å—Ç–æ—Ç—ã
                        const r = Math.floor(plasma1 * 255 * (0.8 + bassIntensity * 0.4));
                        const g = Math.floor(plasma2 * 255 * (0.6 + midIntensity * 0.6));
                        const b = Math.floor(plasma3 * 255 * (0.7 + highIntensity * 0.5));
                        
                        data[i] = r;     // Red
                        data[i + 1] = g; // Green
                        data[i + 2] = b; // Blue
                        data[i + 3] = 255; // Alpha
                    }
                }
                
                this.ctx.putImageData(imageData, 0, 0);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –ø–æ–≤–µ—Ä—Ö
                this.addPostEffects(bassIntensity, midIntensity, highIntensity);
                
                this.time += 0.02;
                this.animationId = requestAnimationFrame(() => this.renderPlasma());
            }

            addPostEffects(bass, mid, high) {
                const width = this.canvas.width / window.devicePixelRatio;
                const height = this.canvas.height / window.devicePixelRatio;
                
                // –ü—É–ª—å—Å–∏—Ä—É—é—â–∏–µ –∫—Ä—É–≥–∏ –æ—Ç —Ü–µ–Ω—Ç—Ä–∞
                const centerX = width / 2;
                const centerY = height / 2;
                
                // –ë–∞—Å-–ø—É–ª—å—Å–∞—Ü–∏–∏
                const bassRadius = 50 + bass * 100;
                const gradient1 = this.ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, bassRadius);
                gradient1.addColorStop(0, `rgba(255, 0, 255, ${0.3 + bass * 0.3})`);
                gradient1.addColorStop(1, 'rgba(255, 0, 255, 0)');
                
                this.ctx.fillStyle = gradient1;
                this.ctx.fillRect(0, 0, width, height);
                
                // –°—Ä–µ–¥–Ω–µ—á–∞—Å—Ç–æ—Ç–Ω—ã–µ –ø—É–ª—å—Å–∞—Ü–∏–∏
                const midRadius = 30 + mid * 80;
                const gradient2 = this.ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, midRadius);
                gradient2.addColorStop(0, `rgba(0, 255, 255, ${0.2 + mid * 0.4})`);
                gradient2.addColorStop(1, 'rgba(0, 255, 255, 0)');
                
                this.ctx.fillStyle = gradient2;
                this.ctx.fillRect(0, 0, width, height);
            }

            updateAudioBars() {
                if (!this.dataArray) return;
                
                const bars = this.audioBars.children;
                for (let i = 0; i < bars.length; i++) {
                    const value = this.dataArray[Math.floor(i * 2)];
                    const height = Math.max(2, (value / 255) * 60);
                    bars[i].style.height = `${height}px`;
                    bars[i].style.opacity = Math.max(0.3, value / 255);
                }
            }

            start() {
                this.renderPlasma();
            }

            stop() {
                if (this.animationId) {
                    cancelAnimationFrame(this.animationId);
                }
            }
        }

        // –ê—É–¥–∏–æ —Å–∏—Å—Ç–µ–º–∞
        let audioActivated = false;
        let plasmaVisualizer = null;
        
        function activateAudioSystem() {
            if (audioActivated) return;
            audioActivated = true;
            
            const audio = document.getElementById('audioElement');
            console.log('üîä –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∞—É–¥–∏–æ —Å–∏—Å—Ç–µ–º—ã');
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä
            plasmaVisualizer = new PlasmaVisualizer();
            
            // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥—Ä–æ–º–∫–æ—Å—Ç—å
            audio.volume = 1.0;
            
            const playAudio = () => {
                audio.play().then(() => {
                    console.log('üéµ –ê—É–¥–∏–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≥—Ä–æ–º–∫–æ—Å—Ç–∏');
                    
                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –∞—É–¥–∏–æ
                    plasmaVisualizer.initAudioAnalyser(audio);
                    plasmaVisualizer.start();
                    
                    // –£—Å–∏–ª–µ–Ω–∏–µ –≥—Ä–æ–º–∫–æ—Å—Ç–∏
                    const volumeBoost = setInterval(() => {
                        audio.volume = 1.0;
                    }, 500);
                    
                }).catch(error => {
                    console.log('‚ö†Ô∏è –û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è, –ø–æ–≤—Ç–æ—Ä...');
                    setTimeout(playAudio, 500);
                });
            };
            
            playAudio();
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            const touchLayer = document.getElementById('touchLayer');
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
            const interactions = [
                'click', 'touchstart', 'touchend', 'touchmove',
                'mousedown', 'mouseup', 'keydown', 'scroll',
                'wheel', 'orientationchange'
            ];
            
            interactions.forEach(event => {
                document.addEventListener(event, activateAudioSystem, { once: false });
            });
            
            // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
            setTimeout(activateAudioSystem, 800);
            
            // –í–∏–±—Ä–∞—Ü–∏—è –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞
            if (navigator.vibrate) {
                navigator.vibrate([50, 25, 50, 25, 50]);
            }
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
        window.addEventListener('resize', () => {
            if (plasmaVisualizer) {
                plasmaVisualizer.resize();
            }
        });
    </script>
</body>
</html>
